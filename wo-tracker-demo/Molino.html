<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Estaci贸n Molino</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <nav>
    <a href="index.html">Dashboard</a> 
    <a href="Molino_ws1.html">Work Station 1</a> 
  </nav>

  <h2>Molino</h2>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Descripci贸n</th>
        <th>Piezas</th>
        <th>Clasificaci贸n</th>
        <th>Tiempo Estimado</th>
        <th>Tiempo Total</th>
        <th>Asignar a</th>
      </tr>
    </thead>
    <tbody id="tabla-molino"></tbody>
  </table>
 <script src="script.js"></script>
  <script>
      function actualizarTablaMolino() {
      const allWOs = JSON.parse(localStorage.getItem("workOrders")) || [];
      const tbody = document.getElementById("tabla-molino");
      tbody.innerHTML = "";
//Asignar A Estacion


  //  Solo las WOs asignadas al 谩rea Molino
     allWOs
    .filter(wo => wo.estado === "Molino")
    .forEach(wo => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${wo.id}</td>
        <td>${wo.descripcion}</td>
        <td>${wo.piezas}</td>
        <td>${wo.clasificacion}</td>
        <td>${wo.tiempoEstimado || "-"}</td>
        <td>${wo.tiempoTotal || "-"}</td>
        <td>
          <select onchange="asignarAEstacion('${wo.id}', this.value)">
            <option value="">-- Enviar a WS --</option>
            <option value="WS1">WS1</option>
            <option value="WS2">WS2</option>
            <option value="WS3">WS3</option>
            <option value="WS4">WS4</option>
          </select>
        </td>
      `;
      tbody.appendChild(tr);
    });
}
function asignarAEstacion(id, estacion) {
  const allWOs = JSON.parse(localStorage.getItem("workOrders")) || [];
  const wo = allWOs.find(w => w.id === id);
  if (!wo) return alert("WO no encontrada");

  wo.estacionAsignada = estacion;
  wo.estado = "En proceso";

  localStorage.setItem("workOrders", JSON.stringify(allWOs));

  //  Redirecci贸n a la p谩gina correspondiente
  if (estacion === "WS1") window.location.href = "Molino_ws1.html";
  if (estacion === "WS2") window.location.href = "Molino_ws2.html";
  if (estacion === "WS3") window.location.href = "Molino_ws3.html";
  if (estacion === "WS4") window.location.href = "Molino_ws4.html";
}


setInterval(() => {
  if (gapi.client.getToken()) {
    monitorearCambios();
  }
}, 10000);

    document.addEventListener("DOMContentLoaded", actualizarTablaMolino);


  </script>


</body>
</html>
